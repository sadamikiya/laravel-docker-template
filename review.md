# Laravel Lesson レビュー①

## Todo一覧機能

### Todoモデルのallメソッドで実行しているSQLは何か
- allメソッドでは、モデルに紐付けられたテーブルのレコードを全取得取得する際に使用される。実行されるSQL文でならSELECT * FROM todos;となる。このクエリではSELECT * はテーブル内の全てのカラムを取得することを意味している。それをtodosテーブルを対象としてクエリを発行している。allメソッドはtodosテーブルを対象にクエリを発行している。

### Todoモデルのallメソッドの返り値は何か
- Todo::all()の返り値は、Eloquentコレクション（Illuminate\Database\Eloquent\Collection）でコレクション元の配列表現を返します。データ存在時の返り値はarrayで返される。

### 配列の代わりにCollectionクラスを使用するメリットは
- 配列の代わりにcollectionクラスを使用するメリットは、collerctionインスタンスは配列操作に特化したクラスであることになります。
Laravelを使用している場合には配列をcollerctionに変換して使うことで例えば5つのTodoインスタンスが格納されている場合でも、Eloquentモデルとして扱いながら効率的に操作できる。データ抽出といった処理を簡潔に記述できる点も大きなメリットとなる。

### view関数の第1・第2引数の指定と何をしているか
- view関数において第一引数には表示する画面のview名を指定、第二引数ではviewに渡すデータを連想配列の形で渡すことができる。
このview関数では第一引数、第二引数で指定したviewをPHPで実行し、HTMLの生成を行う。

### index.blade.phpの$todos・$todoに代入されているものは何か
- view関数で第二引数で指定されたデータがview内で使用できる変数に代入されます。$todosが全てのtodoデータ、$todoはループ中に$todosから取り出された1つのtodoデータとなります。

## Todo作成機能

### Requestクラスのallメソッドは何をしているか
- Requestクラスのall()メソッドでは使用することでフォームから送信された入力データなどのリクエストに含まれるデータを連想配列で取得できる。

### fillメソッドは何をしているか
- Modelのfill()メソッドを使用することで引数に指定した連想配列を一括代入できる。

### $fillableは何のために設定しているか
- fill()メソッドの一括代入だけでは脆弱性があるため対策をせずに使用すると悪意あるユーザーに攻撃される可能性がある。$fillableプロパティを定義することで、代入を許可する属性を制限することができる。

### saveメソッドで実行しているSQLは何か
- ->save()メソッドを実行すると新しいデータはINSERTになる。
既存データの場合にはUPDATEとなる。

### redirect()->route()は何をしているか
- redirect()->route()は指定したルート名に基づいてユーザーを別のページにリダイレクトをする。ルートが変更された場合にも名前で管理ができるため保守性が向上する。

## その他

### テーブル構成をマイグレーションファイルで管理するメリット
- マイグレーションを使用する理由としてSQLを知らなくてもPHPコードでテーブルを操作できる点、
マイグレーションファイルをGitで共有することで開発者全員が同じテーブルを作成できる。
現在のデータベースの状態を他の開発者に共有することができる。

### マイグレーションファイルのup()、down()は何のコマンドを実行した時に呼び出されるのか
-UP（）メソッドはphp artisan migrateのコマンドを実行すると呼び出される。
UP（）はデータベースに新しいテーブル、カラム、インデックスを追加するために使用する。
down()メソッドはphp artisan migration:rollback（reset）のコマンドを実行すると呼び出される。
down()はup（）メソッドで実行された変更の取り消しを行う。

### Seederクラスの役割は何か
- Seederクラスの実行によりテストデータや初期設定を作成し開発者間で差異が生じないようにするための役割を持つ。

### route関数の引数・返り値・使用するメリット
- route関数は指定したルート名のURLを生成するための関数。
第一引数には指定したルートを示している、第二引数では、そのURLとHTTPメソッドの組み合わせで実行したい処理を記述する。
返り値は指定したルート名に基づくURL(文字列)を返します。
この使用するメリットはURLの変更にも柔軟対応できるため、可読性が高いなどがあるため。

### @extends・@section・@yieldの関係性とbladeを分割するメリット
- 親テンプレートとなる（base.blade.php）部分にyield（'任意の文字列'）を記述して内容を埋め込む子となるテンプレートに
@extends（'Bladeのファイルのパス'）を使うことで親テンプレートを継承する。
さらに子テンプレート内で@section（'任意の文字列'）を使うことで親テンプレートの@yeild（'任意の文字列'）に対応した内容を埋め込むことができる。
分割するメリットとしては複数のbladeを組み合わせてHTMLを生成することが可能。
また、重複するコードを共通化することで再利用できるため保守性が向上する。

### @csrfは何のための記述か
- CSRF(クロスサイトリクエストフォージェリ)攻撃の対策として記述する。
CSRFトークンを一意のキーとしてHTMLフォームを埋め込み、サーバー側でトークンの検証を行います。
このトークンを使うことで悪意あるリクエストを防ぐことができます。

### {{ }}とは何の省略系か
- {{}}とはLaravelではヘルパ関数と呼ばれる関数の一種です。
URLを動的に生成することができます。
route()で使用した場合にはルートの名前を使用してURLを生成します。
また、{{}}を使用することでLaravlは出力内容をHTMLエスケープします。これにより
XSS攻撃（クロスサイトスクリプティング）のリスクが軽減できる。